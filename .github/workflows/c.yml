name: Tests C

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/discobluff/docker_aoc:latest
      credentials:
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}

    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Clone inputs
      run: git clone https://x-access-token:${{ secrets.AOC_INPUTS }}@github.com/Discobluff/advent-of-code-inputs.git inputs

    - name: Copy inputs
      run: |
        for year in inputs/*; do
          if [ -d "$year" ]; then
        for day in "$year"/*; do
          if [ -d "$day" ]; then
            cp "$day/input.txt" "c/$year/$day/input.txt"
          fi
        done
          fi
        done

    - name: Run test
      working-directory: ./c/2021
      run: make test01
